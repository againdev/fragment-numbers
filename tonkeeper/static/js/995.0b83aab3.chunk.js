"use strict";(self.webpackChunk_tonkeeper_extension=self.webpackChunk_tonkeeper_extension||[]).push([[995],{10995:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ks});var s=t(30168),r=t(80184),i=t(47712),o=t(11707),a=t(72791),l=t(57689),d=t(65867),c=t(29305),p=t(41235),u=t(20727),m=t(87594),h=t(94216),x=t(34692),g=t(23098),v=t(86445);const f=1,j=.3,w=()=>{const e=(0,g._H)();return(0,p.useQuery)([v.l.SWAP_OPTIONS],(async()=>{const n=await e.storage.get(v.l.SWAP_OPTIONS);return{slippagePercent:(null===n||void 0===n?void 0:n.slippagePercent)||f,maxPriceImpact:(null===n||void 0===n?void 0:n.maxPriceImpact)||j}}))};var y=t(91153);const b=e=>"stonfi"===e.provider?{provider:"stonfi",stonfiTrade:e.trade.rawTrade}:"dedust"===e.provider?{provider:"dedust",dedustTrade:e.trade.rawTrade}:void(0,u.U)(e);var S=t(53006),A=t(35976),k=t(5784),C=t(96238),Z=t(88674),z=t(93853),_=t(61945),T=t(48544),O=t(76978),P=t(24539),E=t(1849),F=t(39079),M=t(14182),N=t(9356),D=t(97957),R=t(72119);const $=new Map,B=["stonfi","dedust"],G=(0,R.cn)([]);let I=0;function U(){const{api:e}=(0,m.bp)(),[n,t]=(0,R.KO)(G),[s]=(0,S.g7)(),[r]=(0,S.dN)(),[i]=(0,S.y)(),[o,l]=(0,S.K4)(),d=(0,S.RM)(),{swapService:c}=(0,h.W)(),u=(0,p.useQuery)({queryKey:[D.S8.swapCalculate,s.id,r.id,null===i||void 0===i?void 0:i.shiftedBy(s.decimals).toFixed(0)],queryFn:async n=>{let{signal:o}=n;t([]),l(void 0),I+=1;const a=I;if(d)return[];Y(s),Y(r);const p=(0,z.$O)(i,s.decimals);let u=[];return new Promise(((n,i)=>{let d=0;B.forEach((async m=>{try{const h=c.calculateSwap(K(s.address),K(r.address),p.toFixed(0),m);o&&(o.onabort=()=>h.cancel());const x=await h,g=await q(x,e,s,r);if(a!==I)return void i(new Error("Calculation cancelled"));const v=L(g)[0];u=L(u.concat(v)),u[0].trade&&l(u[0]),t((e=>L([...e,v]))),d+=1,d===B.length&&n(u)}catch(h){if(a!==I)return void i(new Error("Calculation cancelled"));console.error(h);const e={provider:m,trade:null};u=L(u.concat(e)),u[0].trade&&l(u[0]),t((n=>L([...n,e]))),d+=1,d===B.length&&n(u)}}))}))},cacheTime:0});return(0,a.useMemo)((()=>({...u,fetchedSwaps:n})),[u,n])}const K=e=>(0,T.kC)(e)?"ton":e.toRawString(),W=e=>"ton"===e?"TON":o.Address.parse(e),L=e=>e.slice().sort(((e,n)=>e.trade?n.trade?n.trade.to.weiAmount.comparedTo(e.trade.to.weiAmount):-1:1)),q=async(e,n,t,s)=>{const r=await J(e.trades,n);if("dedust"===e.provider)return 0===e.trades.length?[{provider:"dedust",trade:null}]:e.trades.map((e=>({provider:"dedust",trade:{from:new O.n({asset:t,weiAmount:e.fromAmount}),to:new O.n({asset:s,weiAmount:e.toAmount}),path:e.path.map((e=>r.find((n=>(0,N.A)(n.address,W(e)))))),blockchainFee:new O.n({asset:E.Ct,weiAmount:e.blockchainFee}),rawTrade:e.dedustRawTrade}})));if("stonfi"===e.provider){const n=e.trades[0];return n?[{provider:"stonfi",trade:{from:new O.n({asset:t,weiAmount:n.fromAmount}),to:new O.n({asset:s,weiAmount:n.toAmount}),blockchainFee:new O.n({asset:E.Ct,weiAmount:n.blockchainFee}),rawTrade:n.stonfiRawTrade,path:n.path.map((e=>r.find((n=>(0,N.A)(n.address,W(e))))))}}]:[{provider:"stonfi",trade:null}]}return[]},J=async(e,n)=>{const t=e.flatMap((e=>e.path.map(W)));return Promise.all(t.map((e=>Q(n,e))))},Y=e=>{$.has(e.address)||$.set(e.address,Promise.resolve(e))},Q=async(e,n)=>{if((0,T.kC)(n))return E.Ct;if($.has(n))return $.get(n);const t=new P.EkG(e.tonApiV2).getJettonInfo({accountId:n.toRawString()}).then((e=>({symbol:e.metadata.symbol,decimals:Number(e.metadata.decimals),name:e.metadata.name,blockchain:M.S.TON,address:n,id:(0,F.G)(M.S.TON,n),image:e.metadata.image})));return $.set(n,t),t};var H=t(88754);const V=e=>{let{onClick:n,isEncodingProcess:t}=e;const{t:s}=(0,_.$G)(),[i]=(0,S.y)(),[o]=(0,S.g7)(),{data:a}=(0,S.Fu)(),{isFetching:l,data:d}=U(),[c]=(0,S.K4)(),p=(0,S.MT)(),{data:u}=w();if((0,S.RM)())return(0,r.jsx)(H.zx,{size:"medium",secondary:!0,disabled:!0,children:s("swap_enter_amount")});if(!l&&null!==d&&void 0!==d&&d.every((e=>!e.trade)))return(0,r.jsx)(H.zx,{size:"medium",disabled:!0,children:s("swap_trade_is_not_available")});if(l&&(null===c||void 0===c||!c.trade)||!a||void 0===p||!u)return(0,r.jsx)(H.zx,{size:"medium",secondary:!0,loading:!0,children:s("continue")});if(!c||!c.trade)return(0,r.jsx)(H.zx,{size:"medium",secondary:!0,disabled:!0,children:s("swap_trade_is_not_available")});if(null===i||void 0===i?void 0:i.gt((0,z.PE)(a,o.decimals)))return(0,r.jsx)(H.zx,{size:"medium",secondary:!0,disabled:!0,children:s("swap_not_enough_funds")});return(null===p||void 0===p?void 0:p.gt(u.maxPriceImpact))?(0,r.jsx)(H.zx,{size:"medium",secondary:!0,disabled:!0,children:s("swap_price_impact_too_high")}):(0,r.jsx)(H.zx,{size:"medium",primary:!0,onClick:n,loading:t,children:s("continue")})};var X=t(89242),ee=t(20504),ne=t(90820);const te=(0,a.forwardRef)(((e,n)=>{let{className:t,isDisabled:s}=e;const{t:i}=(0,_.$G)(),[o,a]=(0,ee.L)();return(0,r.jsx)(ne.II,{value:o,onChange:e=>a(e),ref:n,disabled:s,label:i("swap_search"),clearButton:!0,className:t,size:"small"})}));var se,re,ie,oe,ae=t(61819);const le=d.zo.div(se||(se=(0,s.Z)(["\n    display: flex;\n    flex-direction: column;\n    text-align: center;\n"]))),de=(0,d.zo)(i.pN)(re||(re=(0,s.Z)(["\n    display: block;\n    margin-top: 4px;\n    color: ",";\n"])),(e=>e.theme.textSecondary)),ce=d.zo.div(ie||(ie=(0,s.Z)(["\n    width: 100%;\n    display: flex;\n    gap: 8px;\n    margin-top: 24px;\n\n    > * {\n        flex: 1;\n    }\n"]))),pe=(0,d.zo)(X.P_)(oe||(oe=(0,s.Z)(["\n    ","\n"])),(e=>"full-width"===e.theme.displayType&&"max-width: 400px;")),ue=e=>{let{isOpen:n,onClose:t,tokenSymbol:s}=e;const{t:o}=(0,_.$G)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(pe,{isOpen:n,handleClose:t,children:()=>(0,r.jsxs)(le,{children:[(0,r.jsx)(i.fA,{children:o("swap_import_token_title").replace("%token%",s)}),(0,r.jsx)(de,{children:o("swap_unknown_token_description")}),(0,r.jsxs)(ce,{children:[(0,r.jsx)(H.zx,{primary:!0,onClick:()=>t(!1),children:o("cancel")}),(0,r.jsx)(H.zx,{secondary:!0,onClick:()=>t(!0),children:o("swap_import")})]})]})})})};var me,he,xe,ge,ve,fe,je,we,ye,be,Se=t(27127);const Ae=d.zo.div(me||(me=(0,s.Z)(["\n    overflow-y: auto;\n    width: calc(100% + 2rem);\n    margin: 0 -1rem;\n    height: calc(100% - 54px);\n\n    &::-webkit-scrollbar {\n        display: none;\n    }\n\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n"]))),ke=d.zo.div(he||(he=(0,s.Z)(["\n    width: 100%;\n    height: 1px;\n    background-color: ",";\n"])),(e=>e.theme.separatorCommon)),Ce=e=>{let{walletSwapAssets:n,onSelect:t}=e;const[s,i]=(0,a.useState)(n.slice(0,25)),o=(0,a.useRef)(null);(0,a.useEffect)((()=>{i(n.slice(0,25))}),[n]);return(0,r.jsx)(Ae,{ref:o,onScroll:(0,Se.P2)((()=>{if(null===o||void 0===o||!o.current)return;o.current.scrollHeight-o.current.clientHeight-o.current.scrollTop<300&&i((e=>n.slice(0,e.length+25)))}),100),children:n.length?s.map(((e,s)=>(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(Ne,{onClick:()=>t(e.assetAmount.asset),swapAsset:e}),s!==n.length-1&&(0,r.jsx)(ke,{})]},e.assetAmount.asset.id))):(0,r.jsx)(ze,{onSelect:t})})},Ze=d.zo.div(xe||(xe=(0,s.Z)(["\n    height: 100%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: ",";\n"])),(e=>e.theme.textSecondary)),ze=e=>{let{onSelect:n}=e;const{t:t}=(0,_.$G)(),{data:s,isFetching:o}=(0,ee.UE)(),[l,d]=(0,a.useState)(!1),{mutate:c}=(0,ee.bB)();if(o)return(0,r.jsx)(Ze,{children:(0,r.jsx)(k.L4,{})});if(!s)return(0,r.jsx)(Ze,{children:(0,r.jsx)(i.pN,{children:t("swap_tokens_not_found")})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ue,{isOpen:l,onClose:e=>{d(!1),e&&(c(s.assetAmount.asset),n(s.assetAmount.asset))},tokenSymbol:s.assetAmount.asset.symbol}),(0,r.jsx)(Ne,{onClick:()=>d(!0),swapAsset:s})]})},_e=d.zo.button(ge||(ge=(0,s.Z)(["\n    border: none;\n    width: 100%;\n    padding: 8px 1rem;\n    display: flex;\n    gap: 12px;\n    background-color: transparent;\n\n    transition: background-color 0.15s ease-in-out;\n    cursor: pointer;\n\n    &:hover,\n    &:focus {\n        background-color: ",";\n    }\n"])),(e=>e.theme.backgroundContent)),Te=d.zo.img(ve||(ve=(0,s.Z)(["\n    height: 40px;\n    width: 40px;\n    border-radius: 100%;\n"]))),Oe=d.zo.div(fe||(fe=(0,s.Z)(["\n    display: flex;\n    flex-direction: column;\n    width: calc(100% - 52px);\n"]))),Pe=d.zo.div(je||(je=(0,s.Z)(["\n    display: flex;\n    align-items: center;\n    gap: 4px;\n\n    > *:first-child {\n        display: block;\n        overflow: hidden;\n        text-overflow: ellipsis;\n    }\n\n    > *:nth-child(3) {\n        margin-left: auto;\n    }\n"]))),Ee=d.zo.div(we||(we=(0,s.Z)(["\n    cursor: pointer;\n    &:hover {\n        > svg {\n            color: ",";\n        }\n    }\n"])),(e=>e.theme.iconSecondary)),Fe=(0,d.zo)(Pe)(ye||(ye=(0,s.Z)(["\n    color: ",";\n\n    > *:nth-child(2) {\n        margin-left: auto;\n    }\n"])),(e=>e.theme.textSecondary)),Me=(0,d.zo)(i.fA)(be||(be=(0,s.Z)(["\n    color: ",";\n"])),(e=>e.isZero?e.theme.textTertiary:e.theme.textPrimary)),Ne=e=>{let{swapAsset:n,onClick:t}=e;const s=n.assetAmount.relativeAmount.isZero(),{fiat:o}=(0,m.bp)(),a=(0,g._H)();return(0,r.jsxs)(_e,{onClick:t,children:[(0,r.jsx)(Te,{src:n.assetAmount.asset.image}),(0,r.jsxs)(Oe,{children:[(0,r.jsxs)(Pe,{children:[(0,r.jsx)(i.fA,{children:n.assetAmount.asset.symbol}),(0,r.jsx)(Ee,{onClick:e=>{let t;e.preventDefault(),e.stopPropagation(),t=(0,T.kC)(n.assetAmount.asset.address)?"https://tonviewer.com/price":"https://tonviewer.com/".concat(n.assetAmount.asset.address.toString({urlSafe:!0})),a.openPage(t)},children:(0,r.jsx)(k.AT,{})}),(0,r.jsx)(Me,{isZero:s,children:n.assetAmount.stringRelativeAmount})]}),(0,r.jsxs)(Fe,{children:[(0,r.jsx)(i.De,{children:n.assetAmount.asset.name}),!s&&(0,r.jsx)(i.De,{children:(0,ae.hE)(o,n.fiatAmount)})]})]})]})};var De,Re,$e,Be,Ge,Ie,Ue;const Ke=(0,R.cn)(void 0),We=(0,d.zo)(X.P_)(De||(De=(0,s.Z)(["\n    padding-bottom: 0;\n"]))),Le=()=>{const{t:e}=(0,_.$G)(),[n,t]=(0,R.KO)(Ke),s=e=>{null===n||void 0===n||n.onClose(e),t(void 0)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(We,{isOpen:!!n,handleClose:()=>s(void 0),title:e("swap_tokens"),footer:(0,r.jsx)("div",{}),children:()=>(0,r.jsx)(He,{onSelect:s})})})},qe=(0,d.zo)(te)(Re||(Re=(0,s.Z)(["\n    margin-bottom: 1rem;\n"]))),Je=d.zo.div($e||($e=(0,s.Z)(["\n    ","\n"])),(e=>"full-width"===e.theme.displayType?(0,d.iv)(Be||(Be=(0,s.Z)(["\n                  height: 580px;\n              "]))):(0,d.iv)(Ge||(Ge=(0,s.Z)(["\n                  height: calc(var(--app-height) - 6rem);\n              "]))))),Ye=d.zo.div(Ie||(Ie=(0,s.Z)(["\n    width: calc(100% + 2rem);\n    margin: 0 -1rem;\n    height: 1px;\n    background-color: ",";\n"])),(e=>e.theme.separatorCommon)),Qe=d.zo.div(Ue||(Ue=(0,s.Z)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 300px;\n"]))),He=e=>{let{onSelect:n}=e;const t=(0,ee.r7)(),s=(0,a.useRef)(),[i,o]=(0,ee.L)();return(0,a.useEffect)((()=>(setTimeout((()=>{var e;return null===s||void 0===s||null===(e=s.current)||void 0===e?void 0:e.focus()}),100),()=>o(""))),[]),(0,r.jsxs)(Je,{children:[(0,r.jsx)(qe,{ref:s,isDisabled:!t}),(0,r.jsx)(Ye,{}),t?(0,r.jsx)(Ce,{onSelect:n,walletSwapAssets:t}):(0,r.jsx)(Qe,{children:(0,r.jsx)(k.L4,{})})]})};var Ve,Xe,en;const nn=(0,d.zo)(i.fA)(Ve||(Ve=(0,s.Z)(["\n    display: block;\n    max-width: 80px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    flex-shrink: 0;\n    color: ",";\n\n    transition: color 0.15s ease-in-out;\n"])),(e=>e.theme.textPrimary)),tn=d.zo.button(Xe||(Xe=(0,s.Z)(["\n    border: none;\n    display: flex;\n    align-items: center;\n    background: none;\n    padding: 0;\n    cursor: pointer;\n    gap: 6px;\n    height: 36px;\n    width: fit-content;\n\n    &:hover {\n        > "," {\n            color: ",";\n        }\n    }\n"])),nn,(e=>e.theme.textSecondary)),sn=d.zo.img(en||(en=(0,s.Z)(["\n    height: 24px;\n    width: 24px;\n    border-radius: 100%;\n    flex-shrink: 0;\n"]))),rn=e=>{let{token:n,onTokenChange:t,className:s}=e;const i=(e=>{const[n,t]=(0,R.KO)(Ke);return(0,a.useCallback)((()=>t((()=>({onClose:e})))),[t,e])})((0,a.useCallback)((e=>e&&t(e)),[t]));return(0,r.jsxs)(tn,{className:s,onClick:i,children:[(0,r.jsx)(sn,{src:n.image}),(0,r.jsx)(nn,{children:n.symbol}),(0,r.jsx)(k.UR,{})]})};var on,an=t(27494),ln=t(12850),dn=t(144);const cn=d.zo.input(on||(on=(0,s.Z)(["\n    border: none;\n    background: none;\n    text-align: right;\n    outline: none;\n    width: 30px;\n    color: ",";\n    font-family: inherit;\n\n    ","\n\n    &::placeholder {\n        color: ",";\n    }\n"])),(e=>e.isErrored?e.theme.accentRed:e.theme.textPrimary),i.Dv,(e=>e.theme.textTertiary));var pn,un=t(57443),mn=t(46320);const hn=(0,d.zo)(i.De)(pn||(pn=(0,s.Z)(["\n    color: ",";\n    cursor: default;\n"])),(e=>e.theme.textSecondary)),xn=e=>{let{amount:n,asset:t}=e;const{fiat:s}=(0,m.bp)(),{data:i,isLoading:o}=(0,un.UJ)((0,T.J)(t.address));if(!n)return(0,r.jsx)("div",{});if(!o&&(null===i||void 0===i||!i.prices))return(0,r.jsx)("div",{});if(o)return(0,r.jsx)(mn.Od,{width:"80px",height:"12px",margin:"2px 0"});const a=(0,ae.hE)(s,new x.Z(i.prices).multipliedBy(n));return(0,r.jsxs)(hn,{children:["\u2248\xa0",a]})};var gn,vn,fn,jn=t(60793);const wn=(0,d.zo)(i.De)(gn||(gn=(0,s.Z)(["\n    color: ",";\n"])),(e=>e.theme.textSecondary)),yn=d.zo.div(vn||(vn=(0,s.Z)(["\n    display: flex;\n    height: 16px;\n    align-items: center;\n"]))),bn=d.zo.button(fn||(fn=(0,s.Z)(["\n    border: none;\n    background: none;\n    color: ",";\n    height: fit-content;\n    margin-left: 0.5rem;\n\n    > * {\n        display: block;\n        height: fit-content;\n    }\n\n    &:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n    }\n"])),(e=>e.theme.accentBlue)),Sn=()=>{const[e,n]=(0,S.y)(),[t]=(0,S.g7)(),{data:s}=(0,S.Fu)();return(0,r.jsx)(kn,{balance:s,decimals:t.decimals,onMax:()=>n((0,z.PE)(s,t.decimals))})},An=()=>{const[e]=(0,S.dN)(),n=(0,jn.h)({address:e.address,blockchain:M.S.TON});return(0,r.jsx)(kn,{balance:n,decimals:e.decimals})},kn=e=>{let{balance:n,decimals:t=0,onMax:s}=e;const{t:o}=(0,_.$G)(),a=(0,ae.rs)();return(0,r.jsxs)(yn,{children:[(0,r.jsxs)(wn,{children:[o("swap_balance"),":\xa0"]}),n?(0,r.jsx)(wn,{children:a(n,t)}):(0,r.jsx)(mn.Od,{width:"80px",height:"12px",margin:"2px 0"}),s&&(0,r.jsx)(bn,{disabled:!n||n.isZero(),onClick:s,children:(0,r.jsx)(i.T3,{children:o("swap_max")})})]})};var Cn,Zn,zn,_n,Tn,On;const Pn=d.zo.div(Cn||(Cn=(0,s.Z)(["\n    position: relative;\n    background: ",";\n    border-radius: ",";\n    padding: 6px 12px;\n"])),(e=>e.theme.backgroundContent),(e=>"full-width"===e.theme.displayType?e.theme.corner2xSmall:e.theme.cornerSmall)),En=d.zo.div(Zn||(Zn=(0,s.Z)(["\n    color: ",";\n    gap: 8px;\n    display: flex;\n\n    padding: 4px 0;\n\n    > *:first-child {\n        margin-right: auto;\n    }\n\n    > * {\n        cursor: default;\n    }\n"])),(e=>e.theme.textSecondary)),Fn=d.zo.div(zn||(zn=(0,s.Z)(["\n    display: flex;\n    gap: 8px;\n    padding: 6px 0;\n"]))),Mn=d.zo.div(_n||(_n=(0,s.Z)(["\n    display: flex;\n    gap: 8px;\n    padding: 4px 0;\n    align-items: center;\n    height: 16px;\n\n    > * {\n        margin-left: auto;\n    }\n"]))),Nn=(0,d.zo)(rn)(Tn||(Tn=(0,s.Z)(["\n    flex-shrink: 0;\n"]))),Dn=(0,d.zo)((e=>{let{value:n,onChange:t,decimals:s,className:i,isErrored:o}=e;const[l,d]=(0,a.useState)("");(0,a.useEffect)((()=>{if(n){if(!l.endsWith((0,an.Yz)()))try{new x.Z((0,dn.rf)(l).replace((0,an.Yz)(),".")).eq(n)||d((0,dn.jM)(n))}catch(e){}}else d("")}),[n]);const c=(0,an.Yz)();return(0,r.jsx)(cn,{value:l,onChange:e=>(e=>{let n=(0,ln.VI)(e);if(!n)return d(""),void t(void 0);if((0,ln.vu)(n,s)&&(0,dn.kE)(n)){if(!n.endsWith((0,an.Yz)())){const e=new x.Z((0,dn.rf)(n).replace((0,an.Yz)(),".")),s=new x.Z((0,dn.rf)(l).replace((0,an.Yz)(),"."));e.eq(s)||(t(e),n=(0,dn.z6)(n))}d(n)}})(e.target.value),placeholder:"0".concat(c,"00"),className:i,isErrored:o,inputMode:"decimal"})}))(On||(On=(0,s.Z)(["\n    flex: 1;\n"]))),Rn=e=>{let{children:n}=e;const{t:t}=(0,_.$G)(),[s,o]=(0,S.y)(),[a,l]=(0,S.g7)(),{data:d}=(0,S.Fu)();return(0,r.jsxs)(Pn,{children:[(0,r.jsxs)(En,{children:[(0,r.jsx)(i.De,{children:t("swap_send")}),(0,r.jsx)(Sn,{})]}),(0,r.jsxs)(Fn,{children:[(0,r.jsx)(Nn,{token:a,onTokenChange:l}),(0,r.jsx)(Dn,{value:s,onChange:(0,Se.Ds)(o),decimals:a.decimals,isErrored:!!d&&!!s&&s.gt((0,z.PE)(d,a.decimals))})]}),(0,r.jsx)(Mn,{children:(0,r.jsx)(xn,{amount:s,asset:a})}),n]})};var $n,Bn,Gn,In,Un,Kn,Wn;const Ln=d.zo.div($n||($n=(0,s.Z)(["\n    padding: 0 12px 12px;\n    background: ",";\n    border-radius: ",";\n    height: fit-content;\n"])),(e=>e.theme.backgroundContent),(e=>"full-width"===e.theme.displayType?e.theme.corner2xSmall:e.theme.cornerSmall)),qn=d.zo.div(Bn||(Bn=(0,s.Z)(["\n    color: ",";\n    padding: 10px 0;\n    display: flex;\n    align-items: center;\n    > * {\n        cursor: default;\n    }\n"])),(e=>e.theme.textSecondary)),Jn=()=>{const{t:e}=(0,_.$G)();return(0,S.RM)()?(0,r.jsx)("div",{}):(0,r.jsxs)(Ln,{children:[(0,r.jsx)(qn,{children:(0,r.jsx)(i.De,{children:e("swap_provider")})}),(0,r.jsx)(nt,{provider:"stonfi"}),(0,r.jsx)(nt,{provider:"dedust"})]})},Yn=d.zo.div(Gn||(Gn=(0,s.Z)(["\n    height: 56px;\n    border-radius: ",";\n    border: 1px solid ",";\n    padding: 0 12px;\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n    cursor: ",";\n\n    transition: border-color 0.15s ease-in-out;\n\n    &:not(:last-child) {\n        margin-bottom: 8px;\n    }\n"])),(e=>"full-width"===e.theme.displayType?e.theme.corner2xSmall:e.theme.cornerSmall),(e=>e.isActive?e.theme.accentBlue:e.theme.separatorCommon),(e=>e.isDisabled?"not-allowed":"pointer")),Qn=d.zo.img(In||(In=(0,s.Z)(["\n    width: 24px;\n    height: 24px;\n    border-radius: 6px;\n"]))),Hn=d.zo.div(Un||(Un=(0,s.Z)(["\n    padding: 10px 0;\n    display: flex;\n    flex-direction: column;\n"]))),Vn=d.zo.div(Kn||(Kn=(0,s.Z)(["\n    padding: 10px 0;\n    margin-left: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n"]))),Xn=(0,d.zo)(i.De)(Wn||(Wn=(0,s.Z)(["\n    color: ",";\n"])),(e=>e.theme.textSecondary)),et={stonfi:{imageUrl:"https://wallet.tonkeeper.com/img/swap/stonfi.png",label:"STON.fi"},dedust:{imageUrl:"https://wallet.tonkeeper.com/img/swap/dedust.png",label:"DeDust"}},nt=e=>{let{provider:n}=e;const{t:t}=(0,_.$G)(),[s,o]=(0,S.K4)(),a=(null===s||void 0===s?void 0:s.provider)===n,{fetchedSwaps:l,isFetching:d}=U(),c=l.find((e=>e.provider===n)),p=null===c||void 0===c?void 0:c.trade,[u]=(0,S.dN)(),{data:m,isFetching:h}=(0,un.UJ)((0,T.J)(u.address)),g=0===l.findIndex((e=>e.provider===n))&&!(null===c||void 0===c||!c.trade),v=et[n],{fiatAmount:f}=(0,un.to)(m,(null===p||void 0===p?void 0:p.to.relativeAmount)||new x.Z(0));return(0,r.jsxs)(Yn,{isDisabled:!c||!p,isActive:a,onClick:()=>c&&p&&o(c),children:[(0,r.jsx)(Qn,{src:v.imageUrl}),(0,r.jsxs)(Hn,{children:[(0,r.jsx)(i.fA,{children:v.label}),g&&(0,r.jsx)(Xn,{children:t("swap_best_price")})]}),(0,r.jsx)(Vn,{children:d||p?(0,r.jsxs)(r.Fragment,{children:[p?(0,r.jsx)(i.fA,{children:p.to.stringAssetRelativeAmount}):(0,r.jsx)(mn.Od,{width:"60px",height:"14px",margin:"3px 0"}),m&&p?(0,r.jsxs)(Xn,{children:["\u2248\xa0",f]}):h?(0,r.jsx)(mn.Od,{width:"60px",height:"12px",margin:"2px 0"}):(0,r.jsx)("div",{})]}):(0,r.jsx)(Xn,{children:t("swap_trade_is_not_available")})})]})};var tt,st,rt,it,ot=t(98605);const at=d.zo.div(tt||(tt=(0,s.Z)(["\n    transform: translateY(-100%);\n    visibility: hidden;\n    transition: transform ","ms ease-in-out,\n        visibility ","ms ease-in-out;\n"])),(e=>e.$transitionMS),(e=>e.$transitionMS)),lt=d.zo.div(st||(st=(0,s.Z)(["\n    display: grid;\n    grid-template-rows: ",";\n    overflow: ",";\n    transition: grid-template-rows ","ms ease-in-out;\n\n    "," {\n        ","\n    }\n"])),(e=>e.$isOpened?"1fr":"0fr"),(e=>e.$animationCompleted&&e.$isOpened?"visible":"hidden"),(e=>e.$transitionMS),at,(e=>e.$isOpened&&(0,d.iv)(rt||(rt=(0,s.Z)(["\n                transform: translateY(0);\n                visibility: visible;\n            "]))))),dt=d.zo.div(it||(it=(0,s.Z)(["\n    min-height: 0;\n    min-width: 0;\n"]))),ct=e=>{let{children:n,isOpened:t,transitionMS:s=200}=e;const[i,o]=(0,a.useState)(!1),l=(0,a.useRef)();return(0,a.useEffect)((()=>{clearTimeout(l.current),t?o(!1):l.current=setTimeout((()=>o(!0)),200)}),[t]),(0,r.jsx)(lt,{$animationCompleted:i,$isOpened:t,$transitionMS:s,children:(0,r.jsx)(dt,{children:(0,r.jsx)(at,{$transitionMS:s,children:n})})})};var pt,ut,mt,ht,xt,gt,vt,ft,jt,wt,yt,bt,St,At,kt;const Ct=d.zo.div(pt||(pt=(0,s.Z)([""]))),Zt=d.zo.div(ut||(ut=(0,s.Z)(["\n    cursor: pointer;\n    padding: 4px 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    color: ",";\n\n    svg {\n        color: ",";\n    }\n"])),(e=>e.theme.textSecondary),(e=>e.theme.textSecondary)),zt=d.zo.div(mt||(mt=(0,s.Z)(["\n    transform: translateY(-100%);\n    visibility: hidden;\n    transition: transform 0.2s ease-in-out, visibility 0.2s ease-in-out;\n"]))),_t=(d.zo.div(ht||(ht=(0,s.Z)(["\n    display: grid;\n    grid-template-rows: ",";\n    overflow: ",";\n    transition: grid-template-rows 0.2s ease-in-out;\n\n    "," {\n        ","\n    }\n"])),(e=>e.isOpened?"1fr":"0fr"),(e=>e.animationCompleted&&e.isOpened?"visible":"hidden"),zt,(e=>e.isOpened&&(0,d.iv)(xt||(xt=(0,s.Z)(["\n                transform: translateY(0);\n                visibility: visible;\n            "]))))),d.zo.div(gt||(gt=(0,s.Z)(["\n    min-height: 0;\n"]))),(0,d.zo)(Z.h)(vt||(vt=(0,s.Z)(["\n    transform: ",";\n    transition: transform 0.2s ease-in-out;\n    border: none;\n"])),(e=>e.isOpened?"rotate(180deg)":"rotate(0deg)"))),Tt=d.zo.div(ft||(ft=(0,s.Z)(["\n    position: relative;\n    display: flex;\n    padding: 4px 0;\n    gap: 6px;\n    align-items: center;\n\n    > * {\n        cursor: default;\n    }\n"]))),Ot=d.zo.div(jt||(jt=(0,s.Z)(["\n    pointer-events: none;\n    transform: translate3d(0, -10px, 0);\n    z-index: 100;\n    left: 0;\n    right: 0;\n    transition: all 0.15s ease-in-out;\n    opacity: 0;\n    position: absolute;\n    background-color: ",";\n    padding: 8px 12px;\n    ",";\n    ",";\n\n    ","\n"])),(e=>e.theme.backgroundContentTint),ot.G,i.C2,(e=>"top"===e.placement?(0,d.iv)(wt||(wt=(0,s.Z)(["\n                  transform: translate3d(0, 10px, 0);\n                  bottom: 30px;\n              "]))):(0,d.iv)(yt||(yt=(0,s.Z)(["\n                  transform: translate3d(0, -10px, 0);\n                  top: 30px;\n              "]))))),Pt=d.zo.div(bt||(bt=(0,s.Z)(["\n    cursor: pointer;\n\n    &:hover + "," {\n        opacity: 1;\n        transform: translate3d(0, 0, 0);\n    }\n"])),Ot),Et=(0,d.zo)(i.De)(St||(St=(0,s.Z)(["\n    color: ",";\n"])),(e=>e.theme.textSecondary)),Ft=(0,d.zo)(i.De)(At||(At=(0,s.Z)(["\n    margin-left: auto;\n"]))),Mt=()=>(0,r.jsx)(mn.Od,{width:"60px",height:"12px",margin:"2px 0"}),Nt=(0,d.zo)(i.De)(kt||(kt=(0,s.Z)(["\n    color: ",";\n"])),(e=>"low"===e.status?e.theme.accentGreen:"medium"===e.status||"unknown"===e.status?e.theme.accentOrange:e.theme.accentRed)),Dt=()=>{const{t:e}=(0,_.$G)(),[n,t]=(0,a.useState)(!1),{isFetching:s}=U(),[o]=(0,S.K4)(),l=(0,S.MT)(),{data:d}=w(),c=(0,S.RM)(),p=null===o||void 0===o?void 0:o.trade;if(!s&&!p||c)return null;return(0,r.jsxs)(Ct,{children:[(0,r.jsxs)(Zt,{onClick:()=>{t((e=>!e))},children:[(0,r.jsx)(i.De,{children:e("swap_tx_info")}),(0,r.jsx)(_t,{transparent:!0,isOpened:n,children:(0,r.jsx)(k.v4,{})})]}),(0,r.jsxs)(ct,{isOpened:n,children:[(0,r.jsxs)(Tt,{children:[(0,r.jsx)(Et,{children:e("swap_price_impact")}),(0,r.jsx)(Pt,{children:(0,r.jsx)(k.uM,{})}),(0,r.jsx)(Ot,{placement:"top",children:e("swap_price_impact_tooltip")}),(0,r.jsx)(Ft,{children:void 0!==l&&p?(0,r.jsx)(Nt,{status:(0,S.DC)(l),children:l?(0,r.jsxs)(r.Fragment,{children:["\u2248\xa0","".concat(l.multipliedBy(100).decimalPlaces(2).toString().replace(".",(0,an.Yz)()).replace("-","+"),"%")]}):e("swap_unknown_price_impact")}):(0,r.jsx)(Mt,{})})]}),(0,r.jsxs)(Tt,{children:[(0,r.jsx)(Et,{children:e("swap_minimum_received")}),(0,r.jsx)(Pt,{children:(0,r.jsx)(k.uM,{})}),(0,r.jsx)(Ot,{placement:"top",children:e("swap_minimum_received_tooltip")}),(0,r.jsx)(Ft,{children:p&&d?(0,r.jsxs)(i.De,{children:["\u2248\xa0",new O.n({weiAmount:p.to.weiAmount.multipliedBy(100-d.slippagePercent).div(100),asset:p.to.asset}).stringAssetRelativeAmount]}):(0,r.jsx)(Mt,{})})]}),(0,r.jsxs)(Tt,{children:[(0,r.jsx)(Et,{children:e("swap_slippage")}),(0,r.jsx)(Pt,{children:(0,r.jsx)(k.uM,{})}),(0,r.jsx)(Ot,{placement:"top",children:e("swap_slippage_tooltip")}),(0,r.jsx)(Ft,{children:p&&d?(0,r.jsxs)(i.De,{children:[d.slippagePercent,"%"]}):(0,r.jsx)(Mt,{})})]}),(0,r.jsxs)(Tt,{children:[(0,r.jsx)(Et,{children:e("swap_blockchain_fee")}),(0,r.jsx)(Pt,{children:(0,r.jsx)(k.uM,{})}),(0,r.jsx)(Ot,{placement:"top",children:e("swap_blockchain_fee_tooltip")}),(0,r.jsx)(Ft,{children:p?(0,r.jsxs)(i.De,{children:["\u2248\xa0",p.blockchainFee.stringAssetRelativeAmount]}):(0,r.jsx)(Mt,{})})]}),(0,r.jsxs)(Tt,{children:[(0,r.jsx)(Et,{children:e("swap_route")}),(0,r.jsx)(Ft,{children:p?(0,r.jsx)(i.De,{children:p.path.map((e=>e.symbol)).join(" \u2192 ")}):(0,r.jsx)(Mt,{})})]})]})]})};var Rt,$t;const Bt=(0,d.zo)(i.De)(Rt||(Rt=(0,s.Z)(["\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    color: ",";\n    cursor: pointer;\n    transition: color 0.15s ease-in-out;\n\n    &:hover {\n        ",";\n    }\n"])),(e=>"medium"===e.impact?e.theme.accentOrange:"high"===e.impact?e.theme.accentRed:e.theme.textSecondary),(e=>"medium"!==e.impact&&"high"!==e.impact&&(0,d.iv)($t||($t=(0,s.Z)(["\n                color: ",";\n            "])),e.theme.textPrimary))),Gt=()=>(0,r.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.18144 1.65C4.63413 0.86592 4.86047 0.473881 5.11842 0.286474C5.64415 -0.0954914 6.35604 -0.0954914 6.88177 0.286474C7.13971 0.473881 7.36606 0.86592 7.81875 1.65L11.1096 7.35L11.1097 7.35001C11.5623 8.13408 11.7887 8.52612 11.822 8.84321C11.8899 9.48949 11.534 10.106 10.9403 10.3703C10.6491 10.5 10.1964 10.5 9.29099 10.5H2.7092C1.80382 10.5 1.35113 10.5 1.05986 10.3703C0.466204 10.106 0.110258 9.48949 0.178184 8.84321C0.211512 8.52612 0.437856 8.13408 0.890544 7.35L4.18144 1.65ZM5.1001 8.1C5.1001 7.60294 5.50304 7.2 6.0001 7.2C6.49715 7.2 6.9001 7.60294 6.9001 8.1C6.9001 8.59706 6.49715 9 6.0001 9C5.50304 9 5.1001 8.59706 5.1001 8.1ZM6.00002 2C5.53718 2 5.16822 2.38674 5.18997 2.84906L5.31946 5.60072C5.33656 5.96414 5.63619 6.25 6.00002 6.25C6.36384 6.25 6.66347 5.96414 6.68057 5.60072L6.81006 2.84906C6.83182 2.38674 6.46285 2 6.00002 2Z",fill:"currentColor"})}),It=()=>{const[e,n]=(0,a.useState)("from"),[t]=(0,S.K4)(),{isFetching:s}=U(),i=(0,S.MT)(),o=s&&!(null!==t&&void 0!==t&&t.trade)||void 0===i;if(!s&&!(null!==t&&void 0!==t&&t.trade))return null;if(o)return(0,r.jsx)(mn.Od,{width:"100px",height:"12px",margin:"2px 0"});const l=t.trade,d="from"===e?l.from:l.to,c="from"===e?l.to:l.from;if(d.relativeAmount.isZero())return null;const p=c.relativeAmount.div(d.relativeAmount),u=O.n.fromRelativeAmount({amount:p,asset:c.asset}),m=(0,S.DC)(i);return(0,r.jsxs)(Bt,{impact:m,onClick:()=>n((e=>"from"===e?"to":"from")),children:["1\xa0",d.asset.symbol,"\xa0\u2248\xa0",u.stringAssetRelativeAmount,("medium"===m||"high"===m)&&(0,r.jsx)(Gt,{})]})};var Ut,Kt,Wt,Lt,qt,Jt,Yt;const Qt=d.zo.div(Ut||(Ut=(0,s.Z)(["\n    background: ",";\n    border-radius: ",";\n    padding: 6px 12px;\n"])),(e=>e.theme.backgroundContent),(e=>"full-width"===e.theme.displayType?e.theme.corner2xSmall:e.theme.cornerSmall)),Ht=d.zo.div(Kt||(Kt=(0,s.Z)(["\n    color: ",";\n    gap: 8px;\n    display: flex;\n\n    padding: 4px 0;\n\n    > *:first-child {\n        margin-right: auto;\n    }\n\n    > * {\n        cursor: default;\n    }\n"])),(e=>e.theme.textSecondary)),Vt=d.zo.div(Wt||(Wt=(0,s.Z)(["\n    display: flex;\n    gap: 8px;\n    padding: 6px 0;\n"]))),Xt=d.zo.div(Lt||(Lt=(0,s.Z)(["\n    margin-left: auto;\n    overflow: auto;\n\n    cursor: default;\n\n    &::-webkit-scrollbar {\n        display: none;\n    }\n\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n"]))),es=d.zo.div(qt||(qt=(0,s.Z)(["\n    display: flex;\n    gap: 8px;\n    padding: 4px 0;\n    align-items: center;\n    height: 16px;\n\n    > :last-child {\n        margin-left: auto;\n    }\n"]))),ns=(0,d.zo)(rn)(Jt||(Jt=(0,s.Z)(["\n    flex-shrink: 0;\n"]))),ts=(0,d.zo)(i.J1)(Yt||(Yt=(0,s.Z)(["\n    color: ",";\n"])),(e=>e.theme.textTertiary)),ss=()=>{var e;const{t:n}=(0,_.$G)(),[t,s]=(0,S.dN)(),{isFetching:o}=U(),[a]=(0,S.K4)();return(0,r.jsxs)(Qt,{children:[(0,r.jsxs)(Ht,{children:[(0,r.jsx)(i.De,{children:n("swap_receive")}),(0,r.jsx)(An,{})]}),(0,r.jsxs)(Vt,{children:[(0,r.jsx)(ns,{token:t,onTokenChange:s}),(0,r.jsx)(Xt,{children:null!==a&&void 0!==a&&a.trade||!o?null!==a&&void 0!==a&&a.trade?(0,r.jsx)(i.J1,{children:a.trade.to.stringRelativeAmount}):(0,r.jsx)(ts,{children:"0"}):(0,r.jsx)(mn.Od,{width:"100px",height:"28px",margin:"4px 0"})})]}),(0,r.jsxs)(es,{children:[(0,r.jsx)(It,{}),(0,r.jsx)(xn,{amount:null===a||void 0===a||null===(e=a.trade)||void 0===e?void 0:e.to.relativeAmount,asset:t})]}),(0,r.jsx)(Dt,{})]})};var rs,is;const os=d.zo.div(rs||(rs=(0,s.Z)(["\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n"]))),as=(0,d.zo)(Z.h)(is||(is=(0,s.Z)(["\n    height: 32px;\n    width: 32px;\n    position: absolute;\n    right: calc(50% - 16px);\n    bottom: -20px;\n    border: none;\n\n    background-color: ",";\n\n    > svg {\n        transition: color 0.15s ease-in-out;\n    }\n\n    &:hover {\n        background-color: ",";\n        > svg {\n            color: ",";\n        }\n    }\n"])),(e=>e.theme.buttonTertiaryBackground),(e=>e.theme.buttonTertiaryBackgroundHighlighted),(e=>e.theme.iconPrimary)),ls=e=>{let{className:n}=e;const t=(0,d.Fg)(),{isLoading:s,mutateAsync:i}=function(){const e=(0,y.rT)(),{swapService:n}=(0,h.W)(),{config:t}=(0,m.bp)(),{data:s}=w(),r=t.web_swaps_referral_address;return(0,p.useMutation)((t=>{if(!s)throw new Error("SwapOptions query was not resolved yet");return n.encodeSwap({swap:b(t),options:{senderAddress:e.rawAddress,slippage:new x.Z(s.slippagePercent).div(100).decimalPlaces(5).toString(),...r&&{referralAddress:o.Address.parse(r).toRawString()}}})}))}(),[u,g]=(0,a.useState)(null),[v]=(0,S.K4)(),[f,j]=(0,S.g7)(),[Z,z]=(0,S.dN)(),[_,T]=(0,S.y)(),O=(0,l.s0)(),[P,E]=(0,A.J)();return(0,r.jsxs)(os,{className:n,children:[(0,r.jsx)(Rn,{children:(0,r.jsx)(as,{onClick:()=>{j(Z),z(f),null!==v&&void 0!==v&&v.trade&&T(v.trade.to.relativeAmount)},children:(0,r.jsx)(k.Td,{})})}),(0,r.jsx)(ss,{}),"compact"===t.displayType&&(0,r.jsx)(Jn,{}),(0,r.jsx)(V,{onClick:async()=>{const e=await i(v);g({valid_until:(Date.now()+6e5)/1e3,messages:[{address:o.Address.parse(e.to).toString({bounceable:!0}),amount:e.value,payload:e.body}]})},isEncodingProcess:s||!!u}),(0,r.jsx)(C.o,{handleClose:e=>{g(null),e&&(O(c.FR.activity),E(!1))},params:u,waitInvalidation:!0}),(0,r.jsx)(Le,{})]})},ds=(0,a.createContext)(null),cs={didCatch:!1,error:null};class ps extends a.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=cs}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var n,t,s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];null===(n=(t=this.props).onReset)||void 0===n||n.call(t,{args:r,reason:"imperative-api"}),this.setState(cs)}}componentDidCatch(e,n){var t,s;null===(t=(s=this.props).onError)||void 0===t||t.call(s,e,n)}componentDidUpdate(e,n){const{didCatch:t}=this.state,{resetKeys:s}=this.props;var r,i;t&&null!==n.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==n.length||e.some(((e,t)=>!Object.is(e,n[t])))}(e.resetKeys,s)&&(null===(r=(i=this.props).onReset)||void 0===r||r.call(i,{next:s,prev:e.resetKeys,reason:"keys"}),this.setState(cs))}render(){const{children:e,fallbackRender:n,FallbackComponent:t,fallback:s}=this.props,{didCatch:r,error:i}=this.state;let o=e;if(r){const e={error:i,resetErrorBoundary:this.resetErrorBoundary};if("function"===typeof n)o=n(e);else if(t)o=(0,a.createElement)(t,e);else{if(null!==s&&!(0,a.isValidElement)(s))throw i;o=s}}return(0,a.createElement)(ds.Provider,{value:{didCatch:r,error:i,resetErrorBoundary:this.resetErrorBoundary}},o)}}var us,ms;const hs=d.zo.label(us||(us=(0,s.Z)(["\n    cursor: pointer;\n    ",";\n    ",";\n    box-sizing: border-box;\n\n    text-align: center;\n\n    padding: 8px 12px;\n\n    background: ",";\n    border: 1px solid transparent;\n    transition: border-color 0.15s ease-in-out;\n"])),ot.G,i.C2,(e=>e.theme.fieldBackground)),xs=d.zo.input(ms||(ms=(0,s.Z)(["\n    display: none;\n\n    &:checked + "," {\n        border: 1px solid ",";\n    }\n"])),hs,(e=>e.theme.accentBlue)),gs=(0,a.forwardRef)(((e,n)=>{const t=(0,a.useId)(),s=e.id||t,{className:i,children:o,...l}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(xs,{type:"radio",ref:n,id:s,...l}),(0,r.jsx)(hs,{className:i,htmlFor:s,children:o})]})}));var vs,fs,js,ws,ys;const bs=e=>{let{isOpen:n,onClose:t}=e;const{t:s}=(0,_.$G)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(X.P_,{isOpen:n,handleClose:t,title:s("swap_settings"),children:()=>(0,r.jsx)(Ts,{onClose:t})})})},Ss=d.zo.div(vs||(vs=(0,s.Z)(["\n    padding-bottom: 10px;\n\n    > * {\n        display: block;\n        cursor: default;\n    }\n\n    > "," {\n        color: ",";\n    }\n"])),i.De,(e=>e.theme.textSecondary)),As=d.zo.div(fs||(fs=(0,s.Z)(["\n    display: flex;\n    gap: 0.5rem;\n    margin-bottom: 2rem;\n"]))),ks=(0,d.zo)(gs)(js||(js=(0,s.Z)(["\n    height: 36px;\n    flex: 1;\n"]))),Cs=d.zo.div(ws||(ws=(0,s.Z)(["\n    display: flex;\n    gap: 0.5rem;\n    > * {\n        flex: 1;\n    }\n"]))),Zs=[.5,1,3,5],zs=Zs[1],_s=d.zo.div(ys||(ys=(0,s.Z)(["\n    height: 200px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n"]))),Ts=e=>{let{onClose:n}=e;const{t:t}=(0,_.$G)(),{data:s}=w(),{mutate:o}=(()=>{const e=(0,g._H)(),n=(0,p.useQueryClient)();return(0,p.useMutation)((async t=>{const s=await e.storage.get(v.l.SWAP_OPTIONS);await e.storage.set(v.l.SWAP_OPTIONS,{...s,...t}),await n.invalidateQueries([v.l.SWAP_OPTIONS])}))})(),[l,d]=(0,a.useState)();if((0,a.useLayoutEffect)((()=>{null!==s&&void 0!==s&&s.slippagePercent&&(Zs.includes(null===s||void 0===s?void 0:s.slippagePercent)?d(null===s||void 0===s?void 0:s.slippagePercent):(d(zs),o({slippagePercent:zs})))}),[null===s||void 0===s?void 0:s.slippagePercent]),!s)return(0,r.jsx)(_s,{children:(0,r.jsx)(k.L4,{})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(Ss,{children:[(0,r.jsx)(i.fA,{children:t("swap_slippage")}),(0,r.jsx)(i.De,{children:t("swap_slippage_description")})]}),(0,r.jsx)(As,{children:Zs.map((e=>(0,r.jsxs)(ks,{name:"slippage-percent",value:e,checked:l===e,onChange:()=>d(e),children:[e,"%"]},e)))}),(0,r.jsxs)(Cs,{children:[(0,r.jsx)(H.zx,{secondary:!0,onClick:n,children:t("cancel")}),(0,r.jsx)(H.zx,{primary:!0,disabled:l===s.slippagePercent,onClick:()=>{o({slippagePercent:l}),null===n||void 0===n||n()},children:t("save")})]})]})},Os=()=>{const[e,n]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Z.S,{onClick:()=>n(!0),children:(0,r.jsx)(k.bZ,{})}),(0,r.jsx)(bs,{isOpen:e,onClose:()=>n(!1)})]})};let Ps=!1;const Es=()=>{const{refetch:e,isFetching:n}=U(),[t,s]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{if(Ps=!1,!n){s(!0);const n=setTimeout((()=>{Ps||(e(),Ps=!0)}),15e3);return()=>clearTimeout(n)}s(!1)}),[n]),(0,r.jsx)(Z.S,{onClick:()=>e(),children:t?(0,r.jsx)(k.ut,{}):(0,r.jsx)(k.Du,{})})};var Fs,Ms,Ns,Ds;const Rs=d.zo.div(Fs||(Fs=(0,s.Z)(["\n    position: relative;\n"]))),$s=d.zo.div(Ms||(Ms=(0,s.Z)(["\n    display: flex;\n"]))),Bs=(0,d.zo)(i.fA)(Ns||(Ns=(0,s.Z)(["\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 5rem;\n    right: 2rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: transparent;\n"]))),Gs=()=>{const{t:e}=(0,_.$G)();return(0,r.jsxs)(Rs,{children:[(0,r.jsxs)($s,{children:[(0,r.jsx)(Es,{}),(0,r.jsx)(Os,{})]}),(0,r.jsx)(Bs,{children:e("wallet_swap")})]})},Is=d.zo.div(Ds||(Ds=(0,s.Z)(["\n    overflow-y: auto;\n    min-height: calc(var(--app-height) - 7rem);\n"]))),Us=()=>(0,r.jsx)(Is,{children:(0,r.jsx)(ls,{})}),Ks=()=>{const[e,n]=(0,A.J)();return(0,r.jsx)(ps,{fallbackRender:(t="Failed to display Swap page",e=>{let{error:n}=e;return(0,r.jsxs)("div",{role:"alert",children:[(0,r.jsx)("p",{children:t}),(0,r.jsx)("p",{children:"Something went wrong:"}),(0,r.jsx)("pre",{style:{color:"red"},children:n.message})]})}),children:(0,r.jsx)(X.P_,{isOpen:e,handleClose:()=>n(!1),title:(0,r.jsx)(Gs,{}),children:()=>(0,r.jsx)(Us,{})})});var t}},20504:(e,n,t)=>{t.d(n,{Iy:()=>S,L:()=>k,UE:()=>Z,bB:()=>_,r7:()=>C});var s=t(41235),r=t(11707),i=t(86445),o=t(14182),a=t(76978),l=t(39079),d=t(48544),c=t(24539),p=t(93853),u=t(27127),m=t(34692),h=t(72791),x=t(87594),g=t(23098),v=t(72119),f=t(97957),j=t(60793),w=t(7393),y=t(57443),b=t(94216);function S(){const{swapService:e}=(0,b.W)(),{data:n}=z();return(0,s.useQuery)({queryKey:[f.S8.swapAllAssets,n],queryFn:async()=>{try{const t=await e.swapAssets();return t.map((e=>{const n="ton"===e.address?"TON":r.Address.parse(e.address);return{id:(0,l.G)(o.S.TON,n),symbol:e.symbol,decimals:e.decimals,name:e.name,image:e.image,blockchain:o.S.TON,address:n}})).filter((e=>!(n||[]).some((n=>n.id===e.id)))).concat(n||[])}catch(t){return console.error(t),[]}},enabled:!!n})}const A=(0,v.cn)("");function k(){return(0,v.KO)(A)}const C=()=>{const[e]=k(),{data:n}=function(){const[e]=(0,j.L)(),{data:n}=S(),{data:t}=(0,y.UJ)(o.C.TON),{fiat:i}=(0,x.bp)();return(0,s.useQuery)({queryKey:[f.S8.swapWalletAssets,n,e,t,i],queryFn:async()=>{if(!e||!n||!t)return[];const s=n.map((n=>{var s;if((0,d.kC)(n.address))return{assetAmount:new a.n({asset:n,weiAmount:e.ton.info.balance}),fiatAmount:(0,p.PE)(new m.Z(e.ton.info.balance)).multipliedBy(t.prices)};const o=e.ton.jettons.balances.find((e=>r.Address.parse(e.jetton.address).equals(n.address)));return{assetAmount:new a.n({asset:n,weiAmount:(null===o||void 0===o?void 0:o.balance)||0}),fiatAmount:(0,p.PE)(new m.Z((null===o||void 0===o?void 0:o.balance)||0),n.decimals).multipliedBy(new m.Z((null===o||void 0===o||null===(s=o.price)||void 0===s||null===(s=s.prices)||void 0===s?void 0:s[i])||0))}}));return s.sort(((e,n)=>e.fiatAmount.isZero()&&n.fiatAmount.isZero()?n.assetAmount.weiAmount.comparedTo(e.assetAmount.weiAmount):n.fiatAmount.comparedTo(e.fiatAmount))),s},enabled:!!e&&!!n&&!!t})}();return(0,h.useMemo)((()=>{if(n)return n.filter((n=>{var t;if(!e)return!0;if((0,u.Ig)(e))return r.Address.parse(e).equals(n.assetAmount.asset.address);const s=e.toUpperCase();return!!(n.assetAmount.asset.symbol.toUpperCase().includes(s)||null!==(t=n.assetAmount.asset.name)&&void 0!==t&&t.toUpperCase().includes(s))||void 0}))}),[e,n])},Z=()=>{const[e]=k(),n=(0,u.Ig)(e),{api:t,fiat:i}=(0,x.bp)(),{data:d}=(0,w.NR)();return(0,s.useQuery)({queryKey:[f.S8.swapCustomToken,e,d,i],queryFn:async()=>{if(!n)return null;try{var s;const n=r.Address.parse(e),u=await new c.EkG(t.tonApiV2).getJettonInfo({accountId:n.toRawString()}),h={address:n,image:u.metadata.image,blockchain:o.S.TON,name:u.metadata.name,symbol:u.metadata.symbol,decimals:Number(u.metadata.decimals),id:(0,l.G)(o.S.TON,n)},x=null===d||void 0===d?void 0:d.balances.find((e=>r.Address.parse(e.jetton.address).equals(n)));return{assetAmount:new a.n({asset:h,weiAmount:(null===x||void 0===x?void 0:x.balance)||new m.Z(0)}),fiatAmount:(0,p.PE)(new m.Z((null===x||void 0===x?void 0:x.balance)||0),h.decimals).multipliedBy(new m.Z((null===x||void 0===x||null===(s=x.price)||void 0===s||null===(s=s.prices)||void 0===s?void 0:s[i])||0))}}catch(u){return console.error(u),null}},enabled:n&&!!d})},z=()=>{const e=(0,g._H)();return(0,s.useQuery)([i.l.SWAP_CUSTOM_ASSETS],(async()=>{const n=await e.storage.get(i.l.SWAP_CUSTOM_ASSETS);return(null===n||void 0===n?void 0:n.map((e=>({...e,blockchain:e.blockchain,address:(0,d.Wx)(e.address),id:(0,l.G)(e.blockchain,e.address)}))))||[]}))},_=()=>{const e=(0,g._H)(),n=(0,s.useQueryClient)();return(0,s.useMutation)((async t=>{const s=await e.storage.get(i.l.SWAP_CUSTOM_ASSETS)||[];await e.storage.set(i.l.SWAP_CUSTOM_ASSETS,[...s,{...t,address:(0,d.J)(t.address)}]),await n.invalidateQueries([i.l.SWAP_CUSTOM_ASSETS])}))}}}]);
//# sourceMappingURL=995.0b83aab3.chunk.js.map